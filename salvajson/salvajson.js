var V=(t,n)=>()=>(n||t((n={exports:{}}).exports,n),n.exports);var re=V(C=>{"use strict";Object.defineProperty(C,"__esModule",{value:!0});C.STRING=C.INSPECT=C.EMPTY=C.AFTER=C.BEFORE=C.CLOSE=C.OPEN=void 0;C.OPEN="o";C.CLOSE="c";C.BEFORE="b";C.AFTER="a";C.EMPTY="";C.INSPECT=Symbol.for("nodejs.util.inspect.custom");C.STRING="string"});var de=V(j=>{"use strict";Object.defineProperty(j,"__esModule",{value:!0});j.makeTextMatcher=j.makeNumberMatcher=j.makeCommentMatcher=j.makeStringMatcher=j.makeLineMatcher=j.makeSpaceMatcher=j.makeFixedMatcher=j.makeMatchMatcher=j.makeToken=j.makePoint=j.makeLex=j.makeNoToken=void 0;var W=re(),M=fe(),We=class{constructor(n,e,i,l){this.len=-1,this.sI=0,this.rI=1,this.cI=1,this.token=[],this.len=n,e!=null&&(this.sI=e),i!=null&&(this.rI=i),l!=null&&(this.cI=l)}toString(){return"Point["+[this.sI+"/"+this.len,this.rI,this.cI]+(0<this.token.length?" "+this.token:"")+"]"}[W.INSPECT](){return this.toString()}},ve=(...t)=>new We(...t);j.makePoint=ve;var He=class{constructor(n,e,i,l,r,s,u){this.isToken=!0,this.name=W.EMPTY,this.tin=-1,this.val=void 0,this.src=W.EMPTY,this.sI=-1,this.rI=-1,this.cI=-1,this.len=-1,this.name=n,this.tin=e,this.src=l,this.val=i,this.sI=r.sI,this.rI=r.rI,this.cI=r.cI,this.use=s,this.why=u,this.len=l==null?0:l.length}resolveVal(n,e){return typeof this.val=="function"?this.val(n,e):this.val}bad(n,e){return this.err=n,e!=null&&(this.use=(0,M.deep)(this.use||{},e)),this}toString(){return"Token["+this.name+"="+this.tin+" "+(0,M.snip)(this.src)+(this.val===void 0||this.name==="#ST"||this.name==="#TX"?"":"="+(0,M.snip)(this.val))+" "+[this.sI,this.rI,this.cI]+(this.use==null?"":" "+(0,M.snip)(""+JSON.stringify(this.use).replace(/"/g,""),22))+(this.err==null?"":" "+this.err)+(this.why==null?"":" "+(0,M.snip)(""+this.why,22))+"]"}[W.INSPECT](){return this.toString()}},Qe=(...t)=>new He(...t);j.makeToken=Qe;var Nt=()=>Qe("",-1,void 0,W.EMPTY,ve(-1));j.makeNoToken=Nt;var wt=(t,n)=>{let e=(0,M.regexp)(null,"^(",t.rePart.fixed,")");return function(l){let r=t.fixed;if(!r.lex)return;if(t.fixed.check){let a=t.fixed.check(l);if(a&&a.done)return a.token}let s=l.pnt,o=l.src.substring(s.sI).match(e);if(o){let a=o[1],m=a.length;if(0<m){let d,p=r.token[a];return p!=null&&(d=l.token(p,void 0,a,s),s.sI+=m,s.cI+=m),d}}}};j.makeFixedMatcher=wt;var Pt=(t,n)=>{let e=(0,M.values)(t.match.value),i=(0,M.values)(t.match.token);return e.length===0&&i.length===0?null:function(r,s,u=0){if(!t.match.lex)return;if(t.match.check){let p=t.match.check(r);if(p&&p.done)return p.token}let a=r.pnt,m=r.src.substring(a.sI),d=s.state==="o"?0:1;for(let p of e)if(p.match instanceof RegExp){let g=m.match(p.match);if(g){let h=g[0],k=h.length;if(0<k){let c,f=p.val?p.val(g):h;return c=r.token("#VL",f,h,a),a.sI+=k,a.cI+=k,c}}}else{let g=p.match(r,s);if(g!=null)return g}for(let p of i)if(!(p.tin$&&!s.spec.def.tcol[d][u].includes(p.tin$)))if(p instanceof RegExp){let g=m.match(p);if(g){let h=g[0],k=h.length;if(0<k){let c,f=p.tin$;return c=r.token(f,h,h,a),a.sI+=k,a.cI+=k,c}}}else{let g=p(r,s);if(g!=null)return g}}};j.makeMatchMatcher=Pt;var Ct=(t,n)=>{let e=n.comment;t.comment={lex:e?!!e.lex:!1,def:(e?.def?(0,M.entries)(e.def):[]).reduce((r,[s,u])=>{if(u==null||u===!1)return r;let o={name:s,start:u.start,end:u.end,line:!!u.line,lex:!!u.lex,eatline:!!u.eatline};return r[s]=o,r},{})};let i=t.comment.lex?(0,M.values)(t.comment.def).filter(r=>r.lex&&r.line):[],l=t.comment.lex?(0,M.values)(t.comment.def).filter(r=>r.lex&&!r.line):[];return function(s,u){if(!t.comment.lex)return;if(t.comment.check){let g=t.comment.check(s);if(g&&g.done)return g.token}let a=s.pnt,m=s.src.substring(a.sI),d=a.rI,p=a.cI;for(let g of i)if(m.startsWith(g.start)){let h=m.length,k=g.start.length;for(p+=g.start.length;k<h&&!t.line.chars[m[k]];)p++,k++;if(g.eatline)for(;k<h&&t.line.chars[m[k]];)t.line.rowChars[m[k]]&&d++,k++;let c=m.substring(0,k),f=s.token("#CM",void 0,c,a);return a.sI+=c.length,a.cI=p,a.rI=d,f}for(let g of l)if(m.startsWith(g.start)){let h=m.length,k=g.start.length,c=g.end;for(p+=g.start.length;k<h&&!m.substring(k).startsWith(c);)t.line.rowChars[m[k]]&&(d++,p=0),p++,k++;if(m.substring(k).startsWith(c)){if(p+=c.length,g.eatline)for(;k<h&&t.line.chars[m[k]];)t.line.rowChars[m[k]]&&d++,k++;let f=m.substring(0,k+c.length),b=s.token("#CM",void 0,f,a);return a.sI+=f.length,a.rI=d,a.cI=p,b}else return s.bad(M.S.unterminated_comment,a.sI,a.sI+9*g.start.length)}}};j.makeCommentMatcher=Ct;var Rt=(t,n)=>{let e=(0,M.regexp)(t.line.lex?null:"s","^(.*?)",...t.rePart.ender);return function(l){if(t.text.check){let d=t.text.check(l);if(d&&d.done)return d.token}let r=t.text,s=l.pnt,u=l.src.substring(s.sI),o=t.value.def,a=t.value.defre,m=u.match(e);if(m){let d=m[1],p=m[2],g;if(d!=null){let h=d.length;if(0<h){let k;if(t.value.lex)if((k=o[d])!==void 0)g=l.token("#VL",k.val,d,s),s.sI+=h,s.cI+=h;else for(let c in a){let f=a[c];if(f.match){let b=f.match.exec(f.consume?u:d);if(b&&(f.consume||b[0].length===d.length)){let I=b[0];if(f.val==null)g=l.token("#VL",I,I,s);else{let N=f.val(b);g=l.token("#VL",N,I,s)}s.sI+=I.length,s.cI+=I.length}}}g==null&&r.lex&&(g=l.token("#TX",d,d,s),s.sI+=h,s.cI+=h)}}if(g&&(g=ct(l,g,p)),g&&0<t.text.modify.length){let h=t.text.modify;for(let k=0;k<h.length;k++)g.val=h[k](g.val,l,t,n)}return g}}};j.makeTextMatcher=Rt;var At=(t,n)=>{let e=t.number,i=(0,M.regexp)(null,["^([-+]?(0(",[e.hex?"x[0-9a-fA-F_]+":null,e.oct?"o[0-7_]+":null,e.bin?"b[01_]+":null].filter(r=>r!=null).join("|"),")|\\.?[0-9]+([0-9_]*[0-9])?)","(\\.[0-9]?([0-9_]*[0-9])?)?","([eE][-+]?[0-9]+([0-9_]*[0-9])?)?"].join("").replace(/_/g,e.sep?(0,M.escre)(e.sepChar):""),")",...t.rePart.ender),l=e.sep?(0,M.regexp)("g",(0,M.escre)(e.sepChar)):void 0;return function(s){if(e=t.number,!e.lex)return;if(t.number.check){let d=t.number.check(s);if(d&&d.done)return d.token}let u=s.pnt,o=s.src.substring(u.sI),a=t.value.def,m=o.match(i);if(m){let d=m[1],p=m[9],g,h=!0;if(d!=null&&(h=!t.number.exclude||!d.match(t.number.exclude))){let k=d.length;if(0<k){let c;if(t.value.lex&&(c=a[d])!==void 0)g=s.token("#VL",c.val,d,u);else{let f=l?d.replace(l,""):d,b=+f;if(isNaN(b)){let I=f[0];(I==="-"||I==="+")&&(b=(I==="-"?-1:1)*+f.substring(1))}isNaN(b)||(g=s.token("#NR",b,d,u),u.sI+=k,u.cI+=k)}}}return h&&(g=ct(s,g,p)),g}}};j.makeNumberMatcher=At;var Lt=(t,n)=>{let e=n.string||{};return t.string=t.string||{},t.string=(0,M.deep)(t.string,{lex:!!e?.lex,quoteMap:(0,M.charset)(e.chars),multiChars:(0,M.charset)(e.multiChars),escMap:{...e.escape},escChar:e.escapeChar,escCharCode:e.escapeChar==null?void 0:e.escapeChar.charCodeAt(0),allowUnknown:!!e.allowUnknown,replaceCodeMap:(0,M.omap)((0,M.clean)({...e.replace}),([i,l])=>[i.charCodeAt(0),l]),hasReplace:!1,abandon:!!e.abandon}),t.string.escMap=(0,M.clean)(t.string.escMap),t.string.hasReplace=0<(0,M.keys)(t.string.replaceCodeMap).length,function(l){let r=t.string;if(!r.lex)return;if(t.string.check){let N=t.string.check(l);if(N&&N.done)return N.token}let{quoteMap:s,escMap:u,escChar:o,escCharCode:a,multiChars:m,allowUnknown:d,replaceCodeMap:p,hasReplace:g}=r,{pnt:h,src:k}=l,{sI:c,rI:f,cI:b}=h,I=k.length;if(s[k[c]]){let N=k[c],le=c,se=f,oe=m[N];++c,++b;let q=[],B;for(c;c<I;c++){b++;let te=k[c];if(B=void 0,N===te){c++;break}else if(o===te){c++,b++;let K=u[k[c]];if(K!=null)q.push(K);else if(k[c]==="x"){c++;let A=parseInt(k.substring(c,c+2),16);if(isNaN(A))return r.abandon?void 0:(c=c-2,b-=2,h.sI=c,h.cI=b,l.bad(M.S.invalid_ascii,c,c+4));let P=String.fromCharCode(A);q.push(P),c+=1,b+=2}else if(k[c]==="u"){c++;let A=k[c]==="{"?(c++,1):0,P=A?6:4,ne=parseInt(k.substring(c,c+P),16);if(isNaN(ne))return r.abandon?void 0:(c=c-2-A,b-=2,h.sI=c,h.cI=b,l.bad(M.S.invalid_unicode,c,c+P+2+2*A));let ae=String.fromCodePoint(ne);q.push(ae),c+=P-1+A,b+=P+A}else if(d)q.push(k[c]);else return r.abandon?void 0:(h.sI=c,h.cI=b-1,l.bad(M.S.unexpected,c,c+1))}else if(g&&(B=p[k.charCodeAt(c)])!==void 0)q.push(B),b++;else{let K=c,A=N.charCodeAt(0),P=k.charCodeAt(c);for(;(!g||(B=p[P])===void 0)&&c<I&&32<=P&&A!==P&&a!==P;)P=k.charCodeAt(++c),b++;if(b--,B===void 0&&P<32)if(oe&&t.line.chars[k[c]])t.line.rowChars[k[c]]&&(h.rI=++f),b=1,q.push(k.substring(K,c+1));else return r.abandon?void 0:(h.sI=c,h.cI=b,l.bad(M.S.unprintable,c,c+1));else q.push(k.substring(K,c)),c--}}if(k[c-1]!==N||h.sI===c-1)return r.abandon?void 0:(h.rI=se,l.bad(M.S.unterminated_string,le,c));let ue=l.token("#ST",q.join(W.EMPTY),k.substring(h.sI,c),h);return h.sI=c,h.rI=f,h.cI=b,ue}}};j.makeStringMatcher=Lt;var Yt=(t,n)=>function(i){if(!t.line.lex)return;if(t.line.check){let p=t.line.check(i);if(p&&p.done)return p.token}let{chars:l,rowChars:r}=t.line,{pnt:s,src:u}=i,{sI:o,rI:a}=s,m=t.line.single,d;for(m&&(d={});l[u[o]]&&!(d&&(d[u[o]]=(d[u[o]]||0)+1,m&&1<d[u[o]]));)a+=r[u[o]]?1:0,o++;if(s.sI<o){let p=u.substring(s.sI,o),g=i.token("#LN",void 0,p,s);return s.sI+=p.length,s.rI=a,s.cI=1,g}};j.makeLineMatcher=Yt;var qt=(t,n)=>function(i){if(!t.space.lex)return;if(t.space.check){let a=t.space.check(i);if(a&&a.done)return a.token}let{chars:l}=t.space,{pnt:r,src:s}=i,{sI:u,cI:o}=r;for(;l[s[u]];)u++,o++;if(r.sI<u){let a=s.substring(r.sI,u),m=i.token("#SP",void 0,a,r);return r.sI+=a.length,r.cI=o,m}};j.makeSpaceMatcher=qt;function ct(t,n,e){let i=t.pnt,l=n;if(t.cfg.fixed.lex&&e!=null&&0<e.length){let s,u=t.cfg.fixed.token[e];u!=null&&(s=t.token(u,void 0,e,i)),s!=null&&(i.sI+=s.src.length,i.cI+=s.src.length,n==null?l=s:i.token.push(s))}return l}var Xe=class{constructor(n){this.src=W.EMPTY,this.ctx={},this.cfg={},this.pnt=ve(-1),this.ctx=n,this.src=n.src(),this.cfg=n.cfg,this.pnt=ve(this.src.length)}token(n,e,i,l,r,s){let u,o;return typeof n=="string"?(o=n,u=(0,M.tokenize)(o,this.cfg)):(u=n,o=(0,M.tokenize)(n,this.cfg)),Qe(o,u,e,i,l||this.pnt,r,s)}next(n,e,i,l){let r,s=this.pnt,u=s.sI,o;if(s.end)r=s.end;else if(0<s.token.length)r=s.token.shift();else if(s.len<=s.sI)s.end=this.token("#ZZ",void 0,"",s),r=s.end;else{try{for(let a of this.cfg.lex.match)if(r=a(this,n,l)){o=a;break}}catch(a){r=r||this.token("#BD",void 0,this.src[s.sI],s,{err:a},a.code||M.S.unexpected)}r=r||this.token("#BD",void 0,this.src[s.sI],s,void 0,M.S.unexpected)}return this.ctx.log&&this.ctx.log(M.S.lex,this.ctx,n,this,s,u,o,r,e,i,l),this.ctx.sub.lex&&this.ctx.sub.lex.map(a=>a(r,n,this.ctx)),r}tokenize(n){return(0,M.tokenize)(n,this.cfg)}bad(n,e,i){return this.token("#BD",void 0,0<=e&&e<=i?this.src.substring(e,i):this.src[this.pnt.sI],void 0,void 0,n)}},Ft=(...t)=>new Xe(...t);j.makeLex=Ft});var fe=V(O=>{"use strict";Object.defineProperty(O,"__esModule",{value:!0});O.values=O.keys=O.omap=O.isarr=O.entries=O.defprop=O.assign=O.S=O.JsonicError=void 0;O.badlex=Dt;O.charset=he;O.clean=Se;O.clone=Gt;O.configure=$t;O.deep=pe;O.errdesc=pt;O.errinject=ft;O.escre=D;O.errsite=ht;O.filterRules=Zt;O.makelog=zt;O.mesc=Kt;O.regexp=ye;O.snip=kt;O.srcfmt=gt;O.tokenize=ie;O.trimstk=Vt;O.parserwrap=Ht;O.prop=bt;O.str=tt;O.findTokenSet=Bt;O.modlist=Wt;O.strinject=vt;O.errmsg=mt;var Y=re(),dt=de(),_e=t=>t==null?[]:Object.keys(t);O.keys=_e;var et=t=>t==null?[]:Object.values(t);O.values=et;var X=t=>t==null?[]:Object.entries(t);O.entries=X;var Q=(t,...n)=>Object.assign(t??{},...n);O.assign=Q;var Jt=t=>Array.isArray(t);O.isarr=Jt;var Ut=Object.defineProperty;O.defprop=Ut;var H=(t,n)=>Object.entries(t||{}).reduce((e,i)=>{let l=n?n(i):i;l[0]===void 0?delete e[i[0]]:e[l[0]]=l[1];let r=2;for(;l[r]!==void 0;)e[l[r]]=l[r+1],r+=2;return e},{});O.omap=H;var L={indent:". ",logindent:"  ",space:" ",gap:"  ",Object:"Object",Array:"Array",object:"object",string:"string",function:"function",unexpected:"unexpected",map:"map",list:"list",elem:"elem",pair:"pair",val:"val",node:"node",no_re_flags:Y.EMPTY,unprintable:"unprintable",invalid_ascii:"invalid_ascii",invalid_unicode:"invalid_unicode",invalid_lex_state:"invalid_lex_state",unterminated_string:"unterminated_string",unterminated_comment:"unterminated_comment",lex:"lex",parse:"parse",error:"error",none:"none",imp_map:"imp,map",imp_list:"imp,list",imp_null:"imp,null",end:"end",open:"open",close:"close",rule:"rule",stack:"stack",nUll:"null",name:"name",make:"make",colon:":"};O.S=L;var me=class extends SyntaxError{constructor(n,e,i,l,r){e=pe({},e);let s=pt(n,e,i,l,r);super(s.message),Q(this,s)}};O.JsonicError=me;function $t(t,n,e){var i,l,r,s,u,o,a,m,d,p,g,h,k,c,f,b,I,N,le,se,oe,q,B,ue,te,K,A,P,ne,ae,je,xe,Ne,we,Pe,Ce,Re,Ae,Le,Ye,qe,Fe,Je,Ue,$e,Be,Ke,Ve,De,ze;let y=n||{};y.t=y.t||{},y.tI=y.tI||1;let F=v=>ie(v,y);e.standard$!==!1&&(F("#BD"),F("#ZZ"),F("#UK"),F("#AA"),F("#SP"),F("#LN"),F("#CM"),F("#NR"),F("#ST"),F("#TX"),F("#VL")),y.safe={key:((i=e.safe)===null||i===void 0?void 0:i.key)!==!1},y.fixed={lex:!!(!((l=e.fixed)===null||l===void 0)&&l.lex),token:e.fixed?H(Se(e.fixed.token),([v,E])=>[E,ie(v,y)]):{},ref:void 0,check:(r=e.fixed)===null||r===void 0?void 0:r.check},y.fixed.ref=H(y.fixed.token,([v,E])=>[v,E]),y.fixed.ref=Object.assign(y.fixed.ref,H(y.fixed.ref,([v,E])=>[E,v])),y.match={lex:!!(!((s=e.match)===null||s===void 0)&&s.lex),value:e.match?H(Se(e.match.value),([v,E])=>[v,E]):{},token:e.match?H(Se(e.match.token),([v,E])=>[ie(v,y),E]):{},check:(u=e.match)===null||u===void 0?void 0:u.check},H(y.match.token,([v,E])=>[v,(E.tin$=+v,E)]);let xt=e.tokenSet?Object.keys(e.tokenSet).reduce((v,E)=>(v[E]=e.tokenSet[E].filter(U=>U!=null).map(U=>F(U)),v),{}):{};y.tokenSet=y.tokenSet||{},X(xt).map(v=>{let E=v[0],U=v[1];y.tokenSet[E]?(y.tokenSet[E].length=0,y.tokenSet[E].push(...U)):y.tokenSet[E]=U}),y.tokenSetTins=X(y.tokenSet).reduce((v,E)=>(v[E[0]]=v[E[0]]||{},E[1].map(U=>v[E[0]][U]=!0),v),{}),y.tokenSetTins.IGNORE=y.tokenSetTins.IGNORE||{},y.space={lex:!!(!((o=e.space)===null||o===void 0)&&o.lex),chars:he((a=e.space)===null||a===void 0?void 0:a.chars),check:(m=e.space)===null||m===void 0?void 0:m.check},y.line={lex:!!(!((d=e.line)===null||d===void 0)&&d.lex),chars:he((p=e.line)===null||p===void 0?void 0:p.chars),rowChars:he((g=e.line)===null||g===void 0?void 0:g.rowChars),single:!!(!((h=e.line)===null||h===void 0)&&h.single),check:(k=e.line)===null||k===void 0?void 0:k.check},y.text={lex:!!(!((c=e.text)===null||c===void 0)&&c.lex),modify:(((f=y.text)===null||f===void 0?void 0:f.modify)||[]).concat((!((b=e.text)===null||b===void 0)&&b.modify?[e.text.modify]:[]).flat()).filter(v=>v!=null),check:(I=e.text)===null||I===void 0?void 0:I.check},y.number={lex:!!(!((N=e.number)===null||N===void 0)&&N.lex),hex:!!(!((le=e.number)===null||le===void 0)&&le.hex),oct:!!(!((se=e.number)===null||se===void 0)&&se.oct),bin:!!(!((oe=e.number)===null||oe===void 0)&&oe.bin),sep:((q=e.number)===null||q===void 0?void 0:q.sep)!=null&&e.number.sep!=="",exclude:(B=e.number)===null||B===void 0?void 0:B.exclude,sepChar:(ue=e.number)===null||ue===void 0?void 0:ue.sep,check:(te=e.number)===null||te===void 0?void 0:te.check},y.value={lex:!!(!((K=e.value)===null||K===void 0)&&K.lex),def:X(((A=e.value)===null||A===void 0?void 0:A.def)||{}).reduce((v,E)=>(E[1]==null||E[1]===!1||E[1].match||(v[E[0]]=E[1]),v),{}),defre:X(((P=e.value)===null||P===void 0?void 0:P.def)||{}).reduce((v,E)=>(E[1]&&E[1].match&&(v[E[0]]=E[1],v[E[0]].consume=!!v[E[0]].consume),v),{})},y.rule={start:((ne=e.rule)===null||ne===void 0?void 0:ne.start)==null?"val":e.rule.start,maxmul:((ae=e.rule)===null||ae===void 0?void 0:ae.maxmul)==null?3:e.rule.maxmul,finish:!!(!((je=e.rule)===null||je===void 0)&&je.finish),include:!((xe=e.rule)===null||xe===void 0)&&xe.include?e.rule.include.split(/\s*,+\s*/).filter(v=>v!==""):[],exclude:!((Ne=e.rule)===null||Ne===void 0)&&Ne.exclude?e.rule.exclude.split(/\s*,+\s*/).filter(v=>v!==""):[]},y.map={extend:!!(!((we=e.map)===null||we===void 0)&&we.extend),merge:(Pe=e.map)===null||Pe===void 0?void 0:Pe.merge},y.list={property:!!(!((Ce=e.list)===null||Ce===void 0)&&Ce.property)};let Ge=Object.keys(y.fixed.token).sort((v,E)=>E.length-v.length).map(v=>D(v)).join("|"),Ze=!((Re=e.comment)===null||Re===void 0)&&Re.lex?(e.comment.def?et(e.comment.def):[]).filter(v=>v&&v.lex).map(v=>D(v.start)).join("|"):"",at=["([",D(_e(he(y.space.lex&&y.space.chars,y.line.lex&&y.line.chars)).join("")),"]",(typeof e.ender=="string"?e.ender.split(""):Array.isArray(e.ender)?e.ender:[]).map(v=>"|"+D(v)).join(""),Ge===""?"":"|",Ge,Ze===""?"":"|",Ze,"|$)"];return y.rePart={fixed:Ge,ender:at,commentStart:Ze},y.re={ender:ye(null,...at),rowChars:ye(null,D((Ae=e.line)===null||Ae===void 0?void 0:Ae.rowChars)),columns:ye(null,"["+D((Le=e.line)===null||Le===void 0?void 0:Le.chars)+"]","(.*)$")},y.lex={empty:!!(!((Ye=e.lex)===null||Ye===void 0)&&Ye.empty),emptyResult:(qe=e.lex)===null||qe===void 0?void 0:qe.emptyResult,match:!((Fe=e.lex)===null||Fe===void 0)&&Fe.match?X(e.lex.match).reduce((v,E)=>{let U=E[0],be=E[1];if(be){let ce=be.make(y,e);ce&&(ce.matcher=U,ce.make=be.make,ce.order=be.order),v.push(ce)}return v},[]).filter(v=>v!=null&&v!==!1&&-1<+v.order).sort((v,E)=>v.order-E.order):[]},y.parse={prepare:et((Je=e.parse)===null||Je===void 0?void 0:Je.prepare)},y.debug={get_console:((Ue=e.debug)===null||Ue===void 0?void 0:Ue.get_console)||(()=>console),maxlen:(($e=e.debug)===null||$e===void 0?void 0:$e.maxlen)==null?99:e.debug.maxlen,print:{config:!!(!((Ke=(Be=e.debug)===null||Be===void 0?void 0:Be.print)===null||Ke===void 0)&&Ke.config),src:(De=(Ve=e.debug)===null||Ve===void 0?void 0:Ve.print)===null||De===void 0?void 0:De.src}},y.error=e.error||{},y.hint=e.hint||{},!((ze=e.config)===null||ze===void 0)&&ze.modify&&_e(e.config.modify).forEach(v=>e.config.modify[v](y,e)),y.debug.print.config&&y.debug.get_console().dir(y,{depth:null}),y.result={fail:[]},e.result&&(y.result.fail=[...e.result.fail]),Q(t.options,e),Q(t.token,y.t),Q(t.tokenSet,y.tokenSet),Q(t.fixed,y.fixed.ref),y}function ie(t,n,e){let i=n.t,l=i[t];return l==null&&Y.STRING===typeof t&&(l=n.tI++,i[l]=t,i[t]=l,i[t.substring(1)]=l,e!=null&&Q(e.token,n.t)),l}function Bt(t,n){return n.tokenSet[t]}function Kt(t,n){return n=new String(t),n.esc=!0,n}function ye(t,...n){return new RegExp(n.map(e=>e.esc?D(e.toString()):e).join(Y.EMPTY),t??"")}function D(t){return t==null?"":t.replace(/[-\\|\]{}()[^$+*?.!=]/g,"\\$&").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\n/g,"\\n")}function pe(t,...n){let e=L.function===typeof t,i=t!=null&&(L.object===typeof t||e);for(let l of n){let r=L.function===typeof l,s=l!=null&&(L.object===typeof l||r),u;if(i&&s&&!r&&Array.isArray(t)===Array.isArray(l))for(let o in l)t[o]=pe(t[o],l[o]);else t=l===void 0?t:r?l:s?L.function===typeof(u=l.constructor)&&L.Object!==u.name&&L.Array!==u.name?l:pe(Array.isArray(l)?[]:{},l):l,e=L.function===typeof t,i=t!=null&&(L.object===typeof t||e)}return t}function ft(t,n,e,i,l,r){let s={...r||{},...r.cfg||{},...r.opts||{},...i||{},...l||{},...r.meta||{},...e||{},code:n,details:e,token:i,rule:l,ctx:r};return vt(t,s,{indent:"  "})}function Vt(t){t.stack&&(t.stack=t.stack.split(`
`).filter(n=>!n.includes("jsonic/jsonic")).map(n=>n.replace(/    at /,"at ")).join(`
`))}function ht(t){let{src:n,sub:e,msg:i,cline:l,row:r,col:s,pos:u}=t;r=r!=null&&0<r?r:1,s=s!=null&&0<s?s:1,u=u!=null&&0<u?u:n==null?0:n.split(`
`).reduce((c,f,b)=>(c+=b<r-1?f.length+1:b===r-1?s:0,c),0);let o=e??Y.EMPTY,a=n.substring(Math.max(0,u-333),u).split(`
`),m=n.substring(u,u+333).split(`
`),d=2+(Y.EMPTY+(r+2)).length,p=r<3?1:r-2,g=c=>(l??"")+(Y.EMPTY+p++).padStart(d," ")+" | "+(l==null?"":"\x1B[0m")+(c??Y.EMPTY),h=a.length;return[2<h?g(a[h-3]):null,1<h?g(a[h-2]):null,g(a[h-1]+m[0])," ".repeat(d)+"   "+" ".repeat(s-1)+(l??"")+"^".repeat(o.length||1)+" "+i+(l==null?"":"\x1B[0m"),g(m[1]),g(m[2])].filter(c=>c!=null).join(`
`)}function mt(t){let n=t.color!=null&&typeof t.color=="object"?t.color:void 0,e=t.color===!0||n,i={reset:e?"\x1B[0m":"",hi:e?"\x1B[91m":"",lo:e?"\x1B[2m":"",line:e?"\x1B[34m":"",...n||{}};return[t.prefix==null?null:typeof t.prefix=="function"?t.prefix(i,t):""+t.prefix,(t.code==null?"":i.hi+"["+(t.name==null?"":t.name+"/")+t.code+"]:")+i.reset+" "+(t.msg==null?"":t.msg),t.row!=null&&t.col!=null||t.file!=null?"  "+i.line+"-->"+i.reset+" "+(t.file==null?"<no-file>":t.file)+(t.row==null||t.col==null?"":":"+t.row+":"+t.col):null,t.src==null?"":ht({src:t.src,sub:t.sub,msg:t.smsg||t.msg,cline:i.line,row:t.row,col:t.col,pos:t.pos})+`
`,t.hint==null?null:t.hint,t.suffix==null?null:typeof t.suffix=="function"?t.suffix(i,t):""+t.suffix].filter(r=>r!=null).join(`
`)}function pt(t,n,e,i,l){var r,s,u;try{let o=l.cfg,a=l.meta,m=ft({msg:o.error[t]||((r=n?.use)===null||r===void 0?void 0:r.err)&&(n.use.err.code||n.use.err.message)||o.error.unknown,hint:(o.hint[t]||((u=(s=n.use)===null||s===void 0?void 0:s.err)===null||u===void 0?void 0:u.message)||o.hint.unknown||"").trim().split(`
`).map(g=>"  "+g).join(`
`)},t,n,e,i,l),d=mt({code:t,name:"jsonic",msg:m.msg,hint:m.hint,src:l.src(),file:a?a.fileName:void 0,row:e.rI,col:e.cI,pos:e.sI,sub:e.src,color:!0,suffix:g=>["","  "+g.lo+"https://jsonic.senecajs.org"+g.reset,"  "+g.lo+"--internal: tag="+(l.opts.tag||"")+"; rule="+i.name+"~"+i.state+"; token="+ie(e.tin,l.cfg)+(e.why==null?"":"~"+e.why)+"; plugins="+l.plgn().map(h=>h.name).join(",")+"--"+g.reset].join(`
`)}),p={internal:{token:e,ctx:l}};return p={...Object.create(p),message:d,code:t,details:n,meta:a,fileName:a?a.fileName:void 0,lineNumber:e.rI,columnNumber:e.cI},p}catch(o){return console.log(o),{}}}function Dt(t,n,e){let i=t.next.bind(t);return t.next=(l,r,s,u)=>{let o=i(l,r,s,u);if(n===o.tin){let a={};throw o.use!=null&&(a.use=o.use),new me(o.why||L.unexpected,a,o,l,e)}return o},t}function zt(t,n){var e,i,l;let r=(l=(i=(e=t.opts)===null||e===void 0?void 0:e.plugin)===null||i===void 0?void 0:i.debug)===null||l===void 0?void 0:l.trace;if(n||r)if(typeof n?.log=="number"||r){let s=!1,u=n?.log;(u===-1||r)&&(u=1,s=!0),t.log=(...o)=>{if(s){let a=o.filter(m=>L.object!=typeof m).map(m=>L.function==typeof m?m.name:m).join(L.gap);t.cfg.debug.get_console().log(a)}else t.cfg.debug.get_console().dir(o,{depth:u})}}else typeof n.log=="function"&&(t.log=n.log);return t.log}function gt(t){return typeof t.debug.print.src=="function"?t.debug.print.src:n=>{let e=n==null?Y.EMPTY:Array.isArray(n)?JSON.stringify(n).replace(/]$/,X(n).filter(i=>isNaN(i[0])).map((i,l)=>(l===0?", ":"")+i[0]+": "+JSON.stringify(i[1]))+"]"):JSON.stringify(n);return e=e.substring(0,t.debug.maxlen)+(t.debug.maxlen<e.length?"...":Y.EMPTY),e}}function tt(t,n=44){let e;try{e=typeof t=="object"?JSON.stringify(t):""+t}catch{e=""+t}return kt(n<e.length?e.substring(0,n-3)+"...":e,n)}function kt(t,n=5){return t===void 0?"":(""+t).substring(0,n).replace(/[\r\n\t]/g,".")}function Gt(t){return pe(Object.create(Object.getPrototypeOf(t)),t)}function he(...t){return t==null?{}:t.filter(n=>n!==!1).map(n=>typeof n=="object"?_e(n).join(Y.EMPTY):n).join(Y.EMPTY).split(Y.EMPTY).reduce((n,e)=>(n[e]=e.charCodeAt(0),n),{})}function Se(t){for(let n in t)t[n]==null&&delete t[n];return t}function Zt(t,n){let e=["open","close"];for(let i of e)t.def[i]=t.def[i].map(l=>(l.g=typeof l.g=="string"?(l.g||"").split(/\s*,+\s*/):l.g||[],l)).filter(l=>n.rule.include.reduce((r,s)=>r||l.g!=null&&l.g.indexOf(s)!==-1,n.rule.include.length===0)).filter(l=>n.rule.exclude.reduce((r,s)=>r&&(l.g==null||l.g.indexOf(s)===-1),!0));return t}function bt(t,n,e){let i=t;try{let l=n.split("."),r;for(let s=0;s<l.length;s++){if(r=l[s],r==="__proto__")throw new Error(r);s<l.length-1&&(t=t[r]=t[r]||{})}if(e!==void 0){if(r==="__proto__")throw new Error(r);t[r]=e}return t[r]}catch{throw new Error("Cannot "+(e===void 0?"get":"set")+" path "+n+" on object: "+tt(i)+(e===void 0?"":" to value: "+tt(e,22)))}}function Wt(t,n){if(n&&t){if(0<t.length){if(n.delete&&0<n.delete.length)for(let i=0;i<n.delete.length;i++){let l=n.delete[i];if(l<0?-1*l<=t.length:l<t.length){let r=(t.length+l)%t.length;t[r]=null}}if(n.move)for(let i=0;i<n.move.length;i+=2){let l=(t.length+n.move[i])%t.length,r=(t.length+n.move[i+1])%t.length,s=t[l];t.splice(l,1),t.splice(r,0,s)}let e=t.filter(i=>i!=null);e.length!==t.length&&(t.length=0,t.push(...e))}if(n.custom){let e=n.custom(t);e!=null&&(t=e)}}return t}function Ht(t){return{start:function(n,e,i,l){try{return t.start(n,e,i,l)}catch(r){if(r.name==="SyntaxError"){let s=0,u=0,o=0,a=Y.EMPTY,m=r.message.match(/^Unexpected token (.) .*position\s+(\d+)/i);if(m){a=m[1],s=parseInt(m[2]),u=n.substring(0,s).replace(/[^\n]/g,Y.EMPTY).length;let p=s-1;for(;-1<p&&n.charAt(p)!==`
`;)p--;o=Math.max(n.substring(p,s).length,0)}let d=r.token||(0,dt.makeToken)("#UK",ie("#UK",e.internal().config),void 0,a,(0,dt.makePoint)(a.length,s,r.lineNumber||u,r.columnNumber||o));throw new me(r.code||"json",r.details||{msg:r.message},d,{},r.ctx||{uI:-1,opts:e.options,cfg:e.internal().config,token:d,meta:i,src:()=>n,root:()=>{},plgn:()=>e.internal().plugins,inst:()=>e,rule:{name:"no-rule"},sub:{},xs:-1,v2:d,v1:d,t0:d,t1:d,tC:-1,kI:-1,rs:[],rsI:0,rsm:{},n:{},log:i?i.log:void 0,F:gt(e.internal().config),u:{},NORULE:{name:"no-rule"},NOTOKEN:{name:"no-token"}})}else throw r}}}}function vt(t,n,e){let i=typeof t,l=Array.isArray(t)?"array":t==null?"string":i==="object"?i:"string",r=l==="object"?t:l==="array"?t.reduce((u,o,a)=>(u[a]=o,u),{}):{_:t},s=n??{};return Object.entries(r).map(u=>r[u[0]]=u[1]==null?"":(""+u[1]).replace(/\{([\w_0-9.]+)}/g,(o,a)=>{var m;let d=bt(s,a);if(d=d===void 0?o:d,typeof d=="object"){let p=(m=d?.constructor)===null||m===void 0?void 0:m.name;p==="Object"||p==="Array"?d=JSON.stringify(d).replace(/([^"])"/g,"$1"):d=d.toString()}else d=""+d;return e&&typeof e.indent=="string"&&(d=d.replace(/\n/g,`
`+e.indent)),d})),l==="string"?r._:l==="array"?Object.values(r):r}});var yt=V(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});Ee.defaults=void 0;var z=de(),Xt={safe:{key:!0},tag:"-",fixed:{lex:!0,token:{"#OB":"{","#CB":"}","#OS":"[","#CS":"]","#CL":":","#CA":","}},match:{lex:!0,token:{}},tokenSet:{IGNORE:["#SP","#LN","#CM"],VAL:["#TX","#NR","#ST","#VL"],KEY:["#TX","#NR","#ST","#VL"]},space:{lex:!0,chars:" 	"},line:{lex:!0,chars:`\r
`,rowChars:`
`,single:!1},text:{lex:!0},number:{lex:!0,hex:!0,oct:!0,bin:!0,sep:"_",exclude:void 0},comment:{lex:!0,def:{hash:{line:!0,start:"#",lex:!0,eatline:!1},slash:{line:!0,start:"//",lex:!0,eatline:!1},multi:{line:!1,start:"/*",end:"*/",lex:!0,eatline:!1}}},string:{lex:!0,chars:"'\"`",multiChars:"`",escapeChar:"\\",escape:{b:"\b",f:"\f",n:`
`,r:"\r",t:"	",v:"\v",'"':'"',"'":"'","`":"`","\\":"\\","/":"/"},allowUnknown:!0,abandon:!1},map:{extend:!0,merge:void 0},list:{property:!0},value:{lex:!0,def:{true:{val:!0},false:{val:!1},null:{val:null}}},ender:[],plugin:{},debug:{get_console:()=>console,maxlen:99,print:{config:!1,src:void 0}},error:{unknown:"unknown error: {code}",unexpected:"unexpected character(s): {src}",invalid_unicode:"invalid unicode escape: {src}",invalid_ascii:"invalid ascii escape: {src}",unprintable:"unprintable character: {src}",unterminated_string:"unterminated string: {src}",unterminated_comment:"unterminated comment: {src}",unknown_rule:"unknown rule: {rulename}",end_of_source:"unexpected end of source"},hint:{unknown:`
Since the error is unknown, this is probably a bug inside jsonic
itself, or a plugin. Please consider posting a github issue - thanks!

Code: {code}, Details: 
{details}`,unexpected:`
The character(s) {src} were not expected at this point as they do not
match the expected syntax, even under the relaxed jsonic rules. If it
is not obviously wrong, the actual syntax error may be elsewhere. Try
commenting out larger areas around this point until you get no errors,
then remove the comments in small sections until you find the
offending syntax. NOTE: Also check if any plugins you are using
expect different syntax in this case.`,invalid_unicode:`
The escape sequence {src} does not encode a valid unicode code point
number. You may need to validate your string data manually using test
code to see how JavaScript will interpret it. Also consider that your
data may have become corrupted, or the escape sequence has not been
generated correctly.`,invalid_ascii:`
The escape sequence {src} does not encode a valid ASCII character. You
may need to validate your string data manually using test code to see
how JavaScript will interpret it. Also consider that your data may
have become corrupted, or the escape sequence has not been generated
correctly.`,unprintable:`
String values cannot contain unprintable characters (character codes
below 32). The character {src} is unprintable. You may need to remove
these characters from your source data. Also check that it has not
become corrupted.`,unterminated_string:`
This string has no end quote.`,unterminated_comment:`
This comment is never closed.`,unknown_rule:`
No rule named $rulename is defined. This is probably an error in the
grammar of a plugin.`,end_of_source:`
Unexpected end of source.`},lex:{match:{match:{order:1e6,make:z.makeMatchMatcher},fixed:{order:2e6,make:z.makeFixedMatcher},space:{order:3e6,make:z.makeSpaceMatcher},line:{order:4e6,make:z.makeLineMatcher},string:{order:5e6,make:z.makeStringMatcher},comment:{order:6e6,make:z.makeCommentMatcher},number:{order:7e6,make:z.makeNumberMatcher},text:{order:8e6,make:z.makeTextMatcher}},empty:!0,emptyResult:void 0},parse:{prepare:{}},rule:{start:"val",finish:!0,maxmul:3,include:"",exclude:""},result:{fail:[]},config:{modify:{}},parser:{start:void 0}};Ee.defaults=Xt});var Et=V(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});G.makeRuleSpec=G.makeNoRule=G.makeRule=void 0;var w=re(),J=fe(),nt=class{constructor(n,e,i){this.i=-1,this.name=w.EMPTY,this.node=null,this.state=w.OPEN,this.n=Object.create(null),this.d=-1,this.u=Object.create(null),this.k=Object.create(null),this.bo=!1,this.ao=!1,this.bc=!1,this.ac=!1,this.os=0,this.cs=0,this.need=0,this.i=e.uI++,this.name=n.name,this.spec=n,this.child=e.NORULE,this.parent=e.NORULE,this.prev=e.NORULE,this.o0=e.NOTOKEN,this.o1=e.NOTOKEN,this.c0=e.NOTOKEN,this.c1=e.NOTOKEN,this.node=i,this.d=e.rsI,this.bo=n.def.bo!=null,this.ao=n.def.ao!=null,this.bc=n.def.bc!=null,this.ac=n.def.ac!=null}process(n,e){return this.spec.process(this,n,e,this.state)}eq(n,e=0){let i=this.n[n];return i==null||i===e}lt(n,e=0){let i=this.n[n];return i==null||i<e}gt(n,e=0){let i=this.n[n];return i==null||i>e}lte(n,e=0){let i=this.n[n];return i==null||i<=e}gte(n,e=0){let i=this.n[n];return i==null||i>=e}toString(){return"[Rule "+this.name+"~"+this.i+"]"}},Me=(...t)=>new nt(...t);G.makeRule=Me;var Qt=t=>Me(_t(t.cfg,{}),t);G.makeNoRule=Qt;var rt=class{constructor(){this.p=w.EMPTY,this.r=w.EMPTY,this.b=0}},St=(...t)=>new rt(...t),en=St(),tn=St(),it=class{constructor(n,e){this.name=w.EMPTY,this.def={open:[],close:[],bo:[],bc:[],ao:[],ac:[],tcol:[]},this.cfg=n,this.def=Object.assign(this.def,e),this.def.open=(this.def.open||[]).filter(i=>i!=null),this.def.close=(this.def.close||[]).filter(i=>i!=null);for(let i of[...this.def.open,...this.def.close])Oe(i)}tin(n){return(0,J.tokenize)(n,this.cfg)}add(n,e,i){let l=i?.append?"push":"unshift",r=((0,J.isarr)(e)?e:[e]).filter(o=>o!=null&&typeof o=="object").map(o=>Oe(o)),s=n==="o"?"open":"close",u=this.def[s];return u[l](...r),u=this.def[s]=(0,J.modlist)(u,i),(0,J.filterRules)(this,this.cfg),this.norm(),this}open(n,e){return this.add("o",n,e)}close(n,e){return this.add("c",n,e)}action(n,e,i,l){let r=this.def[e+i];return n?r.push(l):r.unshift(l),this}bo(n,e){return this.action(e?!!n:!0,w.BEFORE,w.OPEN,e||n)}ao(n,e){return this.action(e?!!n:!0,w.AFTER,w.OPEN,e||n)}bc(n,e){return this.action(e?!!n:!0,w.BEFORE,w.CLOSE,e||n)}ac(n,e){return this.action(e?!!n:!0,w.AFTER,w.CLOSE,e||n)}clear(){return this.def.open.length=0,this.def.close.length=0,this.def.bo.length=0,this.def.ao.length=0,this.def.bc.length=0,this.def.ac.length=0,this}norm(){this.def.open.map(i=>Oe(i)),this.def.close.map(i=>Oe(i));let n=[];this.def.open.reduce(...e(0,0,n)),this.def.open.reduce(...e(0,1,n)),this.def.close.reduce(...e(1,0,n)),this.def.close.reduce(...e(1,1,n)),this.def.tcol=n;function e(i,l,r){r[i]=r[i]||[];let s=r[i][l]=r[i][l]||[];return[function(u,o){if(o.s&&o.s[l]){let a=[...new Set(u.concat(o.s[l]))];u.length=0,u.push(...a)}return u},s]}return this}process(n,e,i,l){e.log&&e.log(J.S.rule,e,n,i);let r=l==="o",s=r?n:e.NORULE,u=r?"O":"C",o=this.def,a=r?o.open:o.close,m=r?n.bo?o.bo:null:n.bc?o.bc:null;if(m){let h;for(let k=0;k<m.length;k++)if(h=m[k].call(this,n,e,s,h),h?.isToken&&h?.err)return this.bad(h,n,e,{is_open:r})}let d=0<a.length?nn(r,a,i,n,e):tn;if(d.h&&(d=d.h(n,e,d,s)||d,u+="H"),d.e)return this.bad(d.e,n,e,{is_open:r});if(d.n)for(let h in d.n)n.n[h]=d.n[h]===0?0:(n.n[h]==null?0:n.n[h])+d.n[h];if(d.u&&(n.u=Object.assign(n.u,d.u)),d.k&&(n.k=Object.assign(n.k,d.k)),d.a){u+="A";let h=d.a(n,e,d);if(h&&h.isToken&&h.err)return this.bad(h,n,e,{is_open:r})}if(d.p){e.rs[e.rsI++]=n;let h=e.rsm[d.p];if(h)s=n.child=Me(h,e,n.node),s.parent=n,s.n={...n.n},0<Object.keys(n.k).length&&(s.k={...n.k}),u+="P`"+d.p+"`";else return this.bad(this.unknownRule(e.t0,d.p),n,e,{is_open:r})}else if(d.r){let h=e.rsm[d.r];if(h)s=Me(h,e,n.node),s.parent=n.parent,s.prev=n,s.n={...n.n},0<Object.keys(n.k).length&&(s.k={...n.k}),u+="R`"+d.r+"`";else return this.bad(this.unknownRule(e.t0,d.r),n,e,{is_open:r})}else r||(s=e.rs[--e.rsI]||e.NORULE);let p=r?n.ao?o.ao:null:n.ac?o.ac:null;if(p){let h;for(let k=0;k<p.length;k++)if(h=p[k](n,e,s,h),h?.isToken&&h?.err)return this.bad(h,n,e,{is_open:r})}s.why=u,e.log&&e.log(J.S.node,e,n,i,s),w.OPEN===n.state&&(n.state=w.CLOSE);let g=n[r?"os":"cs"]-(d.b||0);return g===1?(e.v2=e.v1,e.v1=e.t0,e.t0=e.t1,e.t1=e.NOTOKEN):g==2&&(e.v2=e.t1,e.v1=e.t0,e.t0=e.NOTOKEN,e.t1=e.NOTOKEN),s}bad(n,e,i,l){throw new J.JsonicError(n.err||J.S.unexpected,{...n.use,state:l.is_open?J.S.open:J.S.close},n,e,i)}unknownRule(n,e){return n.err="unknown_rule",n.use=n.use||{},n.use.rulename=e,n}},_t=(...t)=>new it(...t);G.makeRuleSpec=_t;function nn(t,n,e,i,l){let r=en;r.b=0,r.p=w.EMPTY,r.r=w.EMPTY,r.n=void 0,r.h=void 0,r.a=void 0,r.u=void 0,r.k=void 0,r.e=void 0;let s=null,u=0,o=l.cfg.t,a=!0,m=1<<o.AA-1,d=l.cfg.tokenSetTins.IGNORE;function p(k,c,f,b){let I;do I=e.next(k,c,f,b),l.tC++;while(d[I.tin]);return I}let g=n.length;for(u=0;u<g;u++){s=n[u];let k=!1,c=!1;if(a=!0,s.S0){let f=(l.t0=l.NOTOKEN!==l.t0?l.t0:l.t0=p(i,s,u,0)).tin;if(k=!0,a=!!(s.S0[f/31|0]&(1<<f%31-1|m)),a&&(c=s.S1!=null,s.S1)){let b=(l.t1=l.NOTOKEN!==l.t1?l.t1:l.t1=p(i,s,u,1)).tin;c=!0,a=!!(s.S1[b/31|0]&(1<<b%31-1|m))}}if(t?(i.o0=k?l.t0:l.NOTOKEN,i.o1=c?l.t1:l.NOTOKEN,i.os=(k?1:0)+(c?1:0)):(i.c0=k?l.t0:l.NOTOKEN,i.c1=c?l.t1:l.NOTOKEN,i.cs=(k?1:0)+(c?1:0)),a&&s.c&&(a=a&&s.c(i,l,r)),a)break;s=null}a||(r.e=l.t0),s&&(r.n=s.n!=null?s.n:r.n,r.h=s.h!=null?s.h:r.h,r.a=s.a!=null?s.a:r.a,r.u=s.u!=null?s.u:r.u,r.k=s.k!=null?s.k:r.k,r.g=s.g!=null?s.g:r.g,r.e=s.e&&s.e(i,l,r)||void 0,r.p=s.p!=null&&s.p!==!1?typeof s.p=="string"?s.p:s.p(i,l,r):r.p,r.r=s.r!=null&&s.r!==!1?typeof s.r=="string"?s.r:s.r(i,l,r):r.r,r.b=s.b!=null&&s.b!==!1?typeof s.b=="number"?s.b:s.b(i,l,r):r.b);let h=u<n.length;return l.log&&l.log(J.S.parse,l,i,e,h,a,u,s,r),r}function Oe(t){if(w.STRING===typeof t.g?t.g=t.g.split(/\s*,\s*/):t.g==null&&(t.g=[]),t.g=t.g.sort(),!t.s||t.s.length===0)t.s=null;else{let n=u=>u.flat().filter(o=>typeof o=="number"),e=(u,o)=>u.filter(a=>31*o<=a&&a<31*(o+1)),i=(u,o)=>u.reduce((a,m)=>1<<m-(31*o+1)|a,0),l=n([t.s[0]]),r=n([t.s[1]]),s=t;s.S0=0<l.length?new Array(Math.max(...l.map(u=>1+u/31|0))).fill(null).map((u,o)=>o).map(u=>i(e(l,u),u)):null,s.S1=0<r.length?new Array(Math.max(...r.map(u=>1+u/31|0))).fill(null).map((u,o)=>o).map(u=>i(e(r,u),u)):null}return t.p||(t.p=null),t.r||(t.r=null),t.b||(t.b=null),t}});var Ot=V(Z=>{"use strict";Object.defineProperty(Z,"__esModule",{value:!0});Z.makeParser=Z.makeRuleSpec=Z.makeRule=void 0;var rn=re(),R=fe(),Ie=de(),ge=Et();Object.defineProperty(Z,"makeRule",{enumerable:!0,get:function(){return ge.makeRule}});Object.defineProperty(Z,"makeRuleSpec",{enumerable:!0,get:function(){return ge.makeRuleSpec}});var lt=class t{constructor(n,e){this.rsm={},this.options=n,this.cfg=e}rule(n,e){if(n==null)return this.rsm;let i=this.rsm[n];if(e===null)delete this.rsm[n];else if(e!==void 0){i=this.rsm[n]=this.rsm[n]||(0,ge.makeRuleSpec)(this.cfg,{}),i=this.rsm[n]=e(this.rsm[n],this)||this.rsm[n],i.name=n;return}return i}start(n,e,i,l){let r,s=(0,Ie.makeToken)("#ZZ",(0,R.tokenize)("#ZZ",this.cfg),void 0,rn.EMPTY,(0,Ie.makePoint)(-1)),u=(0,Ie.makeNoToken)(),o={uI:0,opts:this.options,cfg:this.cfg,meta:i||{},src:()=>n,root:()=>r,plgn:()=>e.internal().plugins,inst:()=>e,rule:{},sub:e.internal().sub,xs:-1,v2:s,v1:s,t0:u,t1:u,tC:-2,kI:-1,rs:[],rsI:0,rsm:this.rsm,log:void 0,F:(0,R.srcfmt)(this.cfg),u:{},NOTOKEN:u,NORULE:{}};o=(0,R.deep)(o,l);let a=(0,ge.makeNoRule)(o);if(o.NORULE=a,o.rule=a,i&&R.S.function===typeof i.log&&(o.log=i.log),this.cfg.parse.prepare.forEach(c=>c(e,o,i)),n===""){if(this.cfg.lex.empty)return this.cfg.lex.emptyResult;throw new R.JsonicError(R.S.unexpected,{src:n},o.t0,a,o)}let m=(0,R.badlex)((0,Ie.makeLex)(o),(0,R.tokenize)("#BD",this.cfg),o),d=this.rsm[this.cfg.rule.start];if(d==null)return;let p=(0,ge.makeRule)(d,o);r=p;let g=2*(0,R.keys)(this.rsm).length*m.src.length*2*o.cfg.rule.maxmul,h=0;for(;a!==p&&h<g;)o.kI=h,o.rule=p,o.log&&o.log("",o.kI+":"),o.sub.rule&&o.sub.rule.map(c=>c(p,o)),p=p.process(o,m),o.log&&o.log(R.S.stack,o,p,m),h++;if(s.tin!==m.next(p).tin)throw new R.JsonicError(R.S.unexpected,{},o.t0,a,o);let k=o.root().node;if(this.cfg.result.fail.includes(k))throw new R.JsonicError(R.S.unexpected,{},o.t0,a,o);return k}clone(n,e){let i=new t(n,e);return i.rsm=Object.keys(this.rsm).reduce((l,r)=>(l[r]=(0,R.filterRules)(this.rsm[r],this.cfg),l),{}),i.norm(),i}norm(){(0,R.values)(this.rsm).map(n=>n.norm())}},ln=(...t)=>new lt(...t);Z.makeParser=ln});var It=V(Te=>{"use strict";Object.defineProperty(Te,"__esModule",{value:!0});Te.grammar=Mt;Te.makeJSON=sn;function Mt(t){let{deep:n}=t.util,{OB:e,CB:i,OS:l,CS:r,CL:s,CA:u,TX:o,ST:a,ZZ:m}=t.token,{VAL:d,KEY:p}=t.tokenSet,g=(c,f)=>{if(!f.cfg.rule.finish)return f.t0.err="end_of_source",f.t0},h=c=>{let f=c.o0,b=a===f.tin||o===f.tin?f.val:f.src;c.u.key=b};t.rule("val",c=>{c.bo(f=>f.node=void 0).open([{s:[e],p:"map",b:1,g:"map,json"},{s:[l],p:"list",b:1,g:"list,json"},{s:[d],g:"val,json"}]).close([{s:[m],g:"end,json"},{b:1,g:"more,json"}]).bc((f,b)=>{f.node=f.node===void 0?f.child.node===void 0?f.os===0?void 0:f.o0.resolveVal(f,b):f.child.node:f.node})}),t.rule("map",c=>{c.bo(f=>{f.node=Object.create(null)}).open([{s:[e,i],b:1,n:{pk:0},g:"map,json"},{s:[e],p:"pair",n:{pk:0},g:"map,json,pair"}]).close([{s:[i],g:"end,json"}])}),t.rule("list",c=>{c.bo(f=>{f.node=[]}).open([{s:[l,r],b:1,g:"list,json"},{s:[l],p:"elem",g:"list,elem,json"}]).close([{s:[r],g:"end,json"}])}),t.rule("pair",c=>{c.open([{s:[p,s],p:"val",u:{pair:!0},a:h,g:"map,pair,key,json"}]).bc((f,b)=>{f.u.pair&&(f.u.prev=f.node[f.u.key],f.node[f.u.key]=f.child.node)}).close([{s:[u],r:"pair",g:"map,pair,json"},{s:[i],b:1,g:"map,pair,json"}])}),t.rule("elem",c=>{c.open([{p:"val",g:"list,elem,val,json"}]).bc(f=>{f.u.done!==!0&&f.node.push(f.child.node)}).close([{s:[u],r:"elem",g:"list,elem,json"},{s:[r],b:1,g:"list,elem,json"}])});let k=(c,f)=>{let b=c.u.key,I=c.child.node,N=c.u.prev;I=I===void 0?null:I,!(c.u.list&&f.cfg.safe.key&&(b==="__proto__"||b==="constructor"))&&(c.node[b]=N==null?I:f.cfg.map.merge?f.cfg.map.merge(N,I,c,f):f.cfg.map.extend?n(N,I):I)};t.rule("val",c=>{c.open([{s:[p,s],c:f=>f.d==0,p:"map",b:2,g:"pair,jsonic,top"},{s:[p,s],p:"map",b:2,n:{pk:1},g:"pair,jsonic"},{s:[d],g:"val,json"},{s:[[i,r]],b:1,c:f=>0<f.d,g:"val,imp,null,jsonic"},{s:[u],c:f=>f.d===0,p:"list",b:1,g:"list,imp,jsonic"},{s:[u],b:1,g:"list,val,imp,null,jsonic"},{s:[m],g:"jsonic"}],{append:!0,delete:[2]}).close([{s:[[i,r]],b:1,g:"val,json,close",e:(f,b)=>f.d===0?b.t0:void 0},{s:[u],c:f=>f.lte("dlist")&&f.lte("dmap"),r:"list",u:{implist:!0},g:"list,val,imp,comma,jsonic"},{c:f=>f.lte("dlist")&&f.lte("dmap"),r:"list",u:{implist:!0},g:"list,val,imp,space,jsonic",b:1},{s:[m],g:"jsonic"}],{append:!0,move:[1,-1]})}),t.rule("map",c=>{c.bo(f=>{f.n.dmap=1+(f.n.dmap?f.n.dmap:0)}).open([{s:[e,m],b:1,e:g,g:"end,jsonic"}]).open([{s:[p,s],p:"pair",b:2,g:"pair,list,val,imp,jsonic"}],{append:!0}).close([{s:[i],c:f=>f.lte("pk"),g:"end,json"},{s:[i],b:1,g:"path,jsonic"},{s:[[u,r,...d]],b:1,g:"end,path,jsonic"},{s:[m],e:g,g:"end,jsonic"}],{append:!0,delete:[0]})}),t.rule("list",c=>{c.bo(f=>{f.n.dlist=1+(f.n.dlist?f.n.dlist:0),f.prev.u.implist&&(f.node.push(f.prev.node),f.prev.node=f.node)}).open({c:f=>f.prev.u.implist,p:"elem"}).open([{s:[u],p:"elem",b:1,g:"list,elem,val,imp,jsonic"},{p:"elem",g:"list,elem.jsonic"}],{append:!0}).close([{s:[m],e:g,g:"end,jsonic"}],{append:!0})}),t.rule("pair",(c,f)=>{c.open([{s:[u],g:"map,pair,comma,jsonic"}],{append:!0}).bc((b,I)=>{b.u.pair&&k(b,I)}).close([{s:[i],c:b=>b.lte("pk"),b:1,g:"map,pair,json"},{s:[u,i],c:b=>b.lte("pk"),b:1,g:"map,pair,comma,jsonic"},{s:[u,m],g:"end,jsonic"},{s:[u],c:b=>b.lte("pk"),r:"pair",g:"map,pair,json"},{s:[u],c:b=>b.lte("dmap",1),r:"pair",g:"map,pair,jsonic"},{s:[p],c:b=>b.lte("dmap",1),r:"pair",b:1,g:"map,pair,imp,jsonic"},{s:[[i,u,r,...p]],c:b=>0<b.n.pk,b:1,g:"map,pair,imp,path,jsonic"},{s:[r],e:b=>b.c0,g:"end,jsonic"},{s:[m],e:g,g:"map,pair,json"},{r:"pair",b:1,g:"map,pair,imp,jsonic"}],{append:!0,delete:[0,1]})}),t.rule("elem",(c,f)=>{c.open([{s:[u,u],b:2,u:{done:!0},a:b=>b.node.push(null),g:"list,elem,imp,null,jsonic"},{s:[u],u:{done:!0},a:b=>b.node.push(null),g:"list,elem,imp,null,jsonic"},{s:[p,s],e:f.cfg.list.property?void 0:(b,I)=>I.t0,p:"val",n:{pk:1,dmap:1},u:{done:!0,pair:!0,list:!0},a:h,g:"elem,pair,jsonic"}]).bc((b,I)=>{b.u.pair===!0&&(b.u.prev=b.node[b.u.key],k(b,I))}).close([{s:[u,[r,m]],b:1,g:"list,elem,comma,jsonic"},{s:[u],r:"elem",g:"list,elem,json"},{s:[r],b:1,g:"list,elem,json"},{s:[m],e:g,g:"list,elem,json"},{s:[i],e:b=>b.c0,g:"end,jsonic"},{r:"elem",b:1,g:"list,elem,imp,jsonic"}],{delete:[-1,-2]})})}function sn(t){let n=t.make({grammar$:!1,text:{lex:!1},number:{hex:!1,oct:!1,bin:!1,sep:null,exclude:/^00+/},string:{chars:'"',multiChars:"",allowUnknown:!1,escape:{v:null}},comment:{lex:!1},map:{extend:!1},lex:{empty:!1},rule:{finish:!1,include:"json"},result:{fail:[void 0,NaN]},tokenSet:{KEY:["#ST",null,null,null]}});return Mt(n),n}});var jt=V((S,st)=>{"use strict";Object.defineProperty(S,"__esModule",{value:!0});S.root=S.S=S.EMPTY=S.AFTER=S.BEFORE=S.CLOSE=S.OPEN=S.makeTextMatcher=S.makeNumberMatcher=S.makeCommentMatcher=S.makeStringMatcher=S.makeLineMatcher=S.makeSpaceMatcher=S.makeFixedMatcher=S.makeParser=S.makeLex=S.makeRuleSpec=S.makeRule=S.makePoint=S.makeToken=S.util=S.JsonicError=S.Jsonic=void 0;S.make=ke;var $=re();Object.defineProperty(S,"OPEN",{enumerable:!0,get:function(){return $.OPEN}});Object.defineProperty(S,"CLOSE",{enumerable:!0,get:function(){return $.CLOSE}});Object.defineProperty(S,"BEFORE",{enumerable:!0,get:function(){return $.BEFORE}});Object.defineProperty(S,"AFTER",{enumerable:!0,get:function(){return $.AFTER}});Object.defineProperty(S,"EMPTY",{enumerable:!0,get:function(){return $.EMPTY}});var _=fe();Object.defineProperty(S,"JsonicError",{enumerable:!0,get:function(){return _.JsonicError}});Object.defineProperty(S,"S",{enumerable:!0,get:function(){return _.S}});var on=yt(),x=de();Object.defineProperty(S,"makePoint",{enumerable:!0,get:function(){return x.makePoint}});Object.defineProperty(S,"makeToken",{enumerable:!0,get:function(){return x.makeToken}});Object.defineProperty(S,"makeLex",{enumerable:!0,get:function(){return x.makeLex}});Object.defineProperty(S,"makeFixedMatcher",{enumerable:!0,get:function(){return x.makeFixedMatcher}});Object.defineProperty(S,"makeSpaceMatcher",{enumerable:!0,get:function(){return x.makeSpaceMatcher}});Object.defineProperty(S,"makeLineMatcher",{enumerable:!0,get:function(){return x.makeLineMatcher}});Object.defineProperty(S,"makeStringMatcher",{enumerable:!0,get:function(){return x.makeStringMatcher}});Object.defineProperty(S,"makeCommentMatcher",{enumerable:!0,get:function(){return x.makeCommentMatcher}});Object.defineProperty(S,"makeNumberMatcher",{enumerable:!0,get:function(){return x.makeNumberMatcher}});Object.defineProperty(S,"makeTextMatcher",{enumerable:!0,get:function(){return x.makeTextMatcher}});var ee=Ot();Object.defineProperty(S,"makeRule",{enumerable:!0,get:function(){return ee.makeRule}});Object.defineProperty(S,"makeRuleSpec",{enumerable:!0,get:function(){return ee.makeRuleSpec}});Object.defineProperty(S,"makeParser",{enumerable:!0,get:function(){return ee.makeParser}});var Tt=It(),ot={tokenize:_.tokenize,srcfmt:_.srcfmt,clone:_.clone,charset:_.charset,trimstk:_.trimstk,makelog:_.makelog,badlex:_.badlex,errsite:_.errsite,errinject:_.errinject,errdesc:_.errdesc,configure:_.configure,parserwrap:_.parserwrap,mesc:_.mesc,escre:_.escre,regexp:_.regexp,prop:_.prop,str:_.str,clean:_.clean,errmsg:_.errmsg,deep:_.deep,omap:_.omap,keys:_.keys,values:_.values,entries:_.entries};S.util=ot;function ke(t,n){let e=!0;if(t==="jsonic")e=!1;else if(t==="json")return(0,Tt.makeJSON)(T);t=typeof t=="string"?{}:t;let i={parser:null,config:null,plugins:[],sub:{lex:void 0,rule:void 0},mark:Math.random()},l=(0,_.deep)({},n?{...n.options}:t?.defaults$===!1?{}:on.defaults,t||{}),r=function(a,m,d){var p;if(_.S.string===typeof a){let g=r.internal();return(!((p=s.parser)===null||p===void 0)&&p.start?(0,_.parserwrap)(s.parser):g.parser).start(a,r,m,d)}return a},s=o=>{if(o!=null&&_.S.object===typeof o){(0,_.deep)(l,o),(0,_.configure)(r,i.config,l);let a=r.internal().parser;i.parser=a.clone(l,i.config)}return{...r.options}},u={token:o=>(0,_.tokenize)(o,i.config,r),tokenSet:o=>(0,_.findTokenSet)(o,i.config),fixed:o=>i.config.fixed.ref[o],options:(0,_.deep)(s,l),config:()=>(0,_.deep)(i.config),parse:r,use:function(a,m){if(_.S.function!==typeof a)throw new Error("Jsonic.use: the first argument must be a function defining a plugin. See https://jsonic.senecajs.org/plugin");let d=a.name.toLowerCase(),p=(0,_.deep)({},a.defaults||{},m||{});r.options({plugin:{[d]:p}});let g=r.options.plugin[d];return r.internal().plugins.push(a),a.options=g,a(r,g)||r},rule:(o,a)=>r.internal().parser.rule(o,a)||r,make:o=>ke(o,r),empty:o=>ke({defaults$:!1,standard$:!1,grammar$:!1,...o||{}}),id:"Jsonic/"+Date.now()+"/"+(""+Math.random()).substring(2,8).padEnd(6,"0")+(s.tag==null?"":"/"+s.tag),toString:()=>u.id,sub:o=>(o.lex&&(i.sub.lex=i.sub.lex||[],i.sub.lex.push(o.lex)),o.rule&&(i.sub.rule=i.sub.rule||[],i.sub.rule.push(o.rule)),r),util:ot};if((0,_.defprop)(u.make,_.S.name,{value:_.S.make}),e?(0,_.assign)(r,u):(0,_.assign)(r,{empty:u.empty,parse:u.parse,sub:u.sub,id:u.id,toString:u.toString}),(0,_.defprop)(r,"internal",{value:()=>i}),n){for(let a in n)r[a]===void 0&&(r[a]=n[a]);r.parent=n;let o=n.internal();i.config=(0,_.deep)({},o.config),(0,_.configure)(r,i.config,l),(0,_.assign)(r.token,i.config.t),i.plugins=[...o.plugins],i.parser=o.parser.clone(l,i.config)}else{let o={...r,...u};i.config=(0,_.configure)(o,void 0,l),i.plugins=[],i.parser=(0,ee.makeParser)(l,i.config),l.grammar$!==!1&&(0,Tt.grammar)(o)}return r}var T;S.root=T;var ut=S.root=T=ke("jsonic");S.Jsonic=ut;T.Jsonic=T;T.JsonicError=_.JsonicError;T.makeLex=x.makeLex;T.makeParser=ee.makeParser;T.makeToken=x.makeToken;T.makePoint=x.makePoint;T.makeRule=ee.makeRule;T.makeRuleSpec=ee.makeRuleSpec;T.makeFixedMatcher=x.makeFixedMatcher;T.makeSpaceMatcher=x.makeSpaceMatcher;T.makeLineMatcher=x.makeLineMatcher;T.makeStringMatcher=x.makeStringMatcher;T.makeCommentMatcher=x.makeCommentMatcher;T.makeNumberMatcher=x.makeNumberMatcher;T.makeTextMatcher=x.makeTextMatcher;T.OPEN=$.OPEN;T.CLOSE=$.CLOSE;T.BEFORE=$.BEFORE;T.AFTER=$.AFTER;T.EMPTY=$.EMPTY;T.util=ot;T.make=ke;T.S=_.S;S.default=ut;typeof st<"u"&&(st.exports=ut)});var{Jsonic:un}=jt(),an=t=>{try{return JSON.stringify(un(t))}catch(n){return n.message.split(/\n/)[0]}};module.exports=an;
